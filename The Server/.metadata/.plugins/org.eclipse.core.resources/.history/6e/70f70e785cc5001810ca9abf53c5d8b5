package main.servlet;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;

import main.model.services.SharedtableService;
import main.util.GetRequestUtil;

public class ShareTableServlet extends BaseServlet{

	private static final long serialVersionUID = 1L;
	//把requestbody转化为jsonobject
	private JSONObject getRequestJson(HttpServletRequest request) throws IOException
	{
		String jsonString=GetRequestUtil.getRequestJsonString(request);
		JSONObject reqJson=JSON.parseObject(jsonString);
		return reqJson;
	}
	public JSONObject share(HttpServletRequest request, HttpServletResponse response,String userId)throws ServletException, IOException{
		SharedtableService sharedService=new SharedtableService();
		JSONObject reqJson=getRequestJson(request);
		JSONObject resJson=new JSONObject();
		String status=sharedService.share(reqJson.getIntValue("idTs"));
		resJson.put("status", status);
		//gpa不足返回gpafail 操作失败返回fail
	}
	public JSONObject collect(HttpServletRequest request, HttpServletResponse response,String userId)throws ServletException, IOException{
		
		String status=collectionService.collection(reqJson.getIntValue("idST"),reqJson.getIntValue("userId"));
		resJson.put("status",status);//返回success或fail
	}
	public JSONObject share(HttpServletRequest request, HttpServletResponse response,String userId)throws ServletException, IOException{
		SharedtableService sharedService=new SharedtableService();
		String status=sharedService.share(reqJson.getIntValue("idTs"));
		resJson.put("status", status);
		//gpa不足返回gpafail 操作失败返回fail
	}
	public JSONObject share(HttpServletRequest request, HttpServletResponse response,String userId)throws ServletException, IOException{
		SharedtableService sharedService=new SharedtableService();
		String status=sharedService.share(reqJson.getIntValue("idTs"));
		resJson.put("status", status);
		//gpa不足返回gpafail 操作失败返回fail
	}
	public JSONObject share(HttpServletRequest request, HttpServletResponse response,String userId)throws ServletException, IOException{
		SharedtableService sharedService=new SharedtableService();
		String status=sharedService.share(reqJson.getIntValue("idTs"));
		resJson.put("status", status);
		//gpa不足返回gpafail 操作失败返回fail
	}
}
